<div class="dashboard-container">
  <h1>🐘 Sri Lankan Elephant Population Dashboard</h1>
  
  <!-- Loading state -->
  <div *ngIf="loading" class="loading">
    <div class="spinner"></div>
    <p>Loading elephant data from Sri Lankan national parks...</p>
  </div>

  <!-- Error state -->
  <div *ngIf="error" class="error">
    <h3>⚠️ Connection Error</h3>
    <p>{{ error }}</p>
    <button (click)="loadElephantData()" class="retry-btn">🔄 Try Again</button>
    <div class="troubleshoot">
      <p><strong>Troubleshooting:</strong></p>
      <ul>
        <li>Make sure your backend server is running: <code>npm run dev</code></li>
        <li>Check that <code>localhost:3000/api/elephants</code> returns data</li>
        <li>Verify both servers are running on different ports</li>
      </ul>
    </div>
  </div>

  <!-- Success: Display data -->
  <div *ngIf="!loading && !error && elephantData.length > 0" class="content">
    <!-- Summary Cards -->
    <div class="stats-grid">
      <div class="stat-card total-elephants">
        <div class="stat-icon">🐘</div>
        <div class="stat-info">
          <h3>{{ getTotalPopulation() }}</h3>
          <p>Total Elephants</p>
        </div>
      </div>
      
      <div class="stat-card total-parks">
        <div class="stat-icon">🏞️</div>
        <div class="stat-info">
          <h3>{{ elephantData.length }}</h3>
          <p>National Parks</p>
        </div>
      </div>
      
      <div class="stat-card total-area">
        <div class="stat-icon">📏</div>
        <div class="stat-info">
          <h3>{{ getTotalArea() }}</h3>
          <p>Total Area (km²)</p>
        </div>
      </div>
    </div>

    <!-- Data Table -->
    <div class="data-section">
      <h2>🌿 Elephant Population by National Park</h2>
      <div class="table-container">
        <table class="data-table">
          <thead>
            <tr>
              <th>🏞️ National Park</th>
              <th>📍 Province</th>
              <th>🐘 Population</th>
              <th>📏 Area (km²)</th>
              <th>📊 Density (elephants/km²)</th>
              <th>📅 Year</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let elephant of elephantData; let i = index" 
                [class.highlight]="i === 0">
              <td class="park-name">{{ elephant.nationalPark || elephant.region }}</td>
              <td class="province">{{ elephant.province }}</td>
              <td class="population">{{ elephant.population }}</td>
              <td class="area">{{ elephant.area_km2 }}</td>
              <td class="density">{{ (elephant.population / elephant.area_km2).toFixed(2) }}</td>
              <td class="year">{{ elephant.year }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- Conservation Message -->
    <div class="conservation-note">
      <h3>🌱 Conservation Impact</h3>
      <p>Sri Lanka's national parks protect <strong>{{ getTotalPopulation() }}</strong> elephants across <strong>{{ getTotalArea() }}</strong> km² of preserved habitat. These protected areas are crucial for maintaining healthy elephant populations and preventing human-elephant conflict.</p>
    </div>
  </div>

  <!-- No data state -->
  <div *ngIf="!loading && !error && elephantData.length === 0" class="no-data">
    <h3>📊 No Data Available</h3>
    <p>No elephant population data found. The database might be empty.</p>
    <button (click)="loadElephantData()" class="retry-btn">🔄 Refresh</button>
  </div>
</div>